<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>REST API Documentation</title>
        <style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
                    Roboto, Helvetica, Arial, sans-serif;
                max-width: 1200px;
                margin: 0 auto;
                padding: 20px;
                background-color: #f8f9fa;
            }
            .endpoint {
                background: white;
                border-radius: 4px;
                padding: 20px;
                margin: 20px 0;
                box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            }
            .method {
                display: inline-block;
                padding: 6px 12px;
                border-radius: 3px;
                font-weight: bold;
                color: white;
                margin-right: 10px;
            }
            .get {
                background-color: #61affe;
            }
            .post {
                background-color: #49cc90;
            }
            .put {
                background-color: #fca130;
            }
            .delete {
                background-color: #f93e3e;
            }
            .url {
                background: #f0f0f0;
                padding: 10px;
                border-radius: 4px;
                font-family: monospace;
            }
            pre {
                background: #263238;
                color: #fff;
                padding: 15px;
                border-radius: 4px;
                overflow-x: auto;
            }
            h1 {
                color: #32325d;
                border-bottom: 1px solid #eee;
                padding-bottom: 10px;
            }
            h2 {
                color: #3b4151;
                font-size: 1.2em;
            }
            .input-group {
                display: flex;
                gap: 10px;
                align-items: center;
                margin: 10px 0;
            }
            .input-group input,
            .input-group select {
                padding: 8px;
                border: 1px solid #ddd;
                border-radius: 4px;
            }
            .input-group input[type="text"] {
                flex: 1;
            }
            .input-group select {
                width: 100px;
            }
            .example-value {
                width: 150px !important;
            }
            .remove-field-btn {
                background: #f93e3e;
                color: white;
                border: none;
                padding: 5px 10px;
                border-radius: 4px;
                cursor: pointer;
            }
            .submit-btn {
                background: #49cc90;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 4px;
                cursor: pointer;
            }
            .notification {
                padding: 10px;
                margin: 10px 0;
                border-radius: 4px;
                display: none;
            }
            .success {
                background: #49cc90;
                color: white;
            }
            .error {
                background: #f93e3e;
                color: white;
            }
            .container {
                display: flex;
                align-items: center;
                justify-content: space-between;
            }
            .add-btn {
                background: #49cc90;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 4px;
                cursor: pointer;
            }
            .popup {
                display: none;
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: white;
                padding: 20px;
                border-radius: 8px;
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
                z-index: 1000;
                width: 80%;
                max-width: 600px;
            }
            .popup-overlay {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.5);
                z-index: 999;
            }
            .field-group {
                margin: 10px 0;
                padding: 10px;
                border: 1px solid #ddd;
                border-radius: 4px;
            }
            .add-field-btn {
                background: #61affe;
                color: white;
                border: none;
                padding: 5px 10px;
                border-radius: 4px;
                cursor: pointer;
                margin: 5px 0;
            }
            .endpoint-controls {
                float: right;
            }
            .control-btn {
                padding: 5px 10px;
                border: none;
                border-radius: 4px;
                cursor: pointer;
                margin-left: 5px;
            }
            .edit-btn {
                background: #fca130;
                color: white;
            }
            .delete-btn {
                background: #f93e3e;
                color: white;
            }
            .clear-all-btn {
                background: #e83e8c;
                color: white;
                margin-left: 10px;
            }
            .request-body,
            .response-body {
                background: #263238;
                color: #fff;
                padding: 15px;
                border-radius: 4px;
                overflow-x: auto;
                margin: 10px 0;
            }
            .request-body {
                background: #32424a; /* –ù–µ–º–Ω–æ–≥–æ —Å–≤–µ—Ç–ª–µ–µ –¥–ª—è –æ—Ç–ª–∏—á–∏—è */
                border-left: 4px solid #61affe; /* –°–∏–Ω—è—è –ø–æ–ª–æ—Å–∞ –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ */
            }
            .response-body {
                border-left: 4px solid #49cc90; /* –ó–µ–ª–µ–Ω–∞—è –ø–æ–ª–æ—Å–∞ –¥–ª—è –æ—Ç–≤–µ—Ç–∞ */
            }
            pre {
                margin: 0;
                line-height: 1.5;
            }
            .export-btn,
            .import-btn {
                background: #61affe;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 4px;
                cursor: pointer;
                margin-right: 10px;
                transition: transform 0.2s ease, box-shadow 0.2s ease;
            }

            .export-btn:hover,
            .import-btn:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            }

            .export-btn:active,
            .import-btn:active {
                transform: translateY(0);
            }

            @keyframes pulse {
                0% {
                    transform: scale(1);
                }
                50% {
                    transform: scale(1.05);
                }
                100% {
                    transform: scale(1);
                }
            }
        </style>
    </head>
    <body>
        <div class="popup-overlay" id="overlay"></div>
        <div class="popup" id="popup">
            <h2>–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å</h2>
            <form id="newRequestForm">
                <div class="input-group">
                    <label>–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞:</label>
                    <input type="text" id="requestName" required />
                </div>
                <div class="input-group">
                    <label>–¢–∏–ø –∑–∞–ø—Ä–æ—Å–∞:</label>
                    <select id="requestMethod" required>
                        <option value="GET">GET</option>
                        <option value="POST">POST</option>
                        <option value="PUT">PUT</option>
                        <option value="DELETE">DELETE</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>URL —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞:</label>
                    <input type="text" id="requestUrl" required />
                </div>

                <div class="field-group">
                    <h3>–ü–æ–ª—è —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞</h3>
                    <div id="requestFields"></div>
                    <button
                        type="button"
                        class="add-field-btn"
                        onclick="addRequestField()"
                    >
                        –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ
                    </button>
                </div>

                <div class="field-group">
                    <h3>–ü–æ–ª—è –æ—Ç–≤–µ—Ç–∞</h3>
                    <div id="responseFields"></div>
                    <button
                        type="button"
                        class="add-field-btn"
                        onclick="addResponseField()"
                    >
                        –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ
                    </button>
                </div>

                <button type="submit" class="submit-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button
                    type="button"
                    class="submit-btn"
                    style="background: #f93e3e"
                    onclick="closePopup()"
                >
                    –û—Ç–º–µ–Ω–∞
                </button>
            </form>
        </div>
        <div class="container">
            <h1>Kuber Code REST API Documentation</h1>
            <div>
                <button onclick="openPopup()" class="add-btn">
                    –î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å
                </button>
                <button onclick="clearAllRequests()" class="clear-all-btn">
                    –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ
                </button>
            </div>
        </div>

        <script>
            const API_URL = "http://localhost:8080";

            function openPopup() {
                document.getElementById("overlay").style.display = "block";
                document.getElementById("popup").style.display = "block";
            }

            function closePopup() {
                document.getElementById("overlay").style.display = "none";
                document.getElementById("popup").style.display = "none";
            }

            function addRequestField() {
                const div = document.createElement("div");
                div.className = "input-group";
                div.innerHTML = `
                    <input type="text" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ–ª—è" required>
                    <select>
                        <option value="string">String</option>
                        <option value="number">Number</option>
                        <option value="boolean">Boolean</option>
                    </select>
                    <input type="text" placeholder="–ü—Ä–∏–º–µ—Ä –∑–Ω–∞—á–µ–Ω–∏—è" class="example-value">
                    <button type="button" class="remove-field-btn" onclick="this.parentElement.remove()">–£–¥–∞–ª–∏—Ç—å</button>
                `;
                document.getElementById("requestFields").appendChild(div);
            }

            function addResponseField() {
                const div = document.createElement("div");
                div.className = "input-group";
                div.innerHTML = `
                    <input type="text" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ–ª—è" required>
                    <select>
                        <option value="string">String</option>
                        <option value="number">Number</option>
                        <option value="boolean">Boolean</option>
                    </select>
                    <input type="text" placeholder="–ü—Ä–∏–º–µ—Ä –∑–Ω–∞—á–µ–Ω–∏—è" class="example-value">
                    <button type="button" class="remove-field-btn" onclick="this.parentElement.remove()">–£–¥–∞–ª–∏—Ç—å</button>
                `;
                document.getElementById("responseFields").appendChild(div);
            }

            function loadSavedRequests() {
                const savedRequests = JSON.parse(
                    localStorage.getItem("requests") || "[]"
                );
                savedRequests.forEach((request) => {
                    createEndpointElement(request);
                });
            }

            function createEndpointElement(requestData) {
                const endpoint = document.createElement("div");
                endpoint.className = "endpoint";
                endpoint.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <h2>${requestData.name}</h2>
                        <div class="endpoint-controls">
                            <button onclick="editRequest('${
                                requestData.name
                            }')" class="control-btn edit-btn">
                                ‚úé –ò–∑–º–µ–Ω–∏—Ç—å
                            </button>
                            <button onclick="deleteRequest('${
                                requestData.name
                            }')" class="control-btn delete-btn">
                                ‚úï –£–¥–∞–ª–∏—Ç—å
                            </button>
                        </div>
                    </div>
                    <div>
                        <span class="method ${requestData.method.toLowerCase()}">${
                    requestData.method
                }</span>
                        <span class="url">${requestData.url}</span>
                    </div>
                    <div id="${requestData.name.toLowerCase()}-notification" class="notification"></div>
                    <form data-endpoint="${requestData.url}">
                        ${requestData.requestFields
                            .map(
                                (field) => `
                            <div class="input-group">
                                <label>${field.name}:</label>
                                <input type="${
                                    field.type === "number" ? "number" : "text"
                                }" 
                                       name="${field.name}" 
                                       required>
                            </div>
                        `
                            )
                            .join("")}
                        <button type="submit" class="submit-btn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                    </form>
                    <pre class="request-body">
–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:
{
    ${requestData.requestFields
        .map((field) => {
            let defaultValue;
            if (field.example) {
                defaultValue =
                    field.type === "number"
                        ? field.example
                        : `"${field.example}"`;
            } else {
                defaultValue =
                    field.type === "string"
                        ? '"value"'
                        : field.type === "number"
                        ? "0"
                        : "false";
            }
            return `"${field.name}": ${defaultValue}`;
        })
        .join(",\n    ")}
}
                    </pre>
                    <pre class="response-body">
–û—Ç–≤–µ—Ç:
{
    ${requestData.responseFields
        .map((field) => {
            let defaultValue;
            if (field.example) {
                defaultValue =
                    field.type === "number"
                        ? field.example
                        : `"${field.example}"`;
            } else {
                defaultValue =
                    field.type === "string"
                        ? '"value"'
                        : field.type === "number"
                        ? "0"
                        : "false";
            }
            return `"${field.name}": ${defaultValue}`;
        })
        .join(",\n    ")}
}
                    </pre>
                `;
                document.body.appendChild(endpoint);
                return endpoint;
            }

            document.getElementById("newRequestForm").onsubmit = function (e) {
                e.preventDefault();

                const requestData = {
                    name: document.getElementById("requestName").value,
                    method: document.getElementById("requestMethod").value,
                    url: document.getElementById("requestUrl").value,
                    requestFields: Array.from(
                        document.getElementById("requestFields").children
                    ).map((field) => ({
                        name: field.querySelector("input").value,
                        type: field.querySelector("select").value,
                        example: field.querySelector(".example-value").value,
                    })),
                    responseFields: Array.from(
                        document.getElementById("responseFields").children
                    ).map((field) => ({
                        name: field.querySelector("input").value,
                        type: field.querySelector("select").value,
                        example: field.querySelector(".example-value").value,
                    })),
                };

                const savedRequests = JSON.parse(
                    localStorage.getItem("requests") || "[]"
                );
                savedRequests.push(requestData);
                localStorage.setItem("requests", JSON.stringify(savedRequests));

                createEndpointElement(requestData);

                closePopup();
                this.reset();
            };

            document.addEventListener("DOMContentLoaded", loadSavedRequests);

            async function sendRequest(
                endpoint,
                method,
                data = null,
                token = null,
                notificationId
            ) {
                try {
                    const headers = {
                        "Content-Type": "application/json",
                    };

                    if (token) {
                        headers["Authorization"] = `Bearer ${token}`;
                    }

                    const options = {
                        method,
                        headers,
                        body: data ? JSON.stringify(data) : null,
                    };

                    const response = await fetch(
                        `${API_URL}${endpoint}`,
                        options
                    );
                    const result = await response.json();

                    const notification =
                        document.getElementById(notificationId);
                    notification.style.display = "block";

                    if (response.ok) {
                        notification.className = "notification success";
                        notification.textContent = "–ó–∞–ø—Ä–æ—Å —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω!";

                        // –û—á–∏—â–∞–µ–º –ø–æ–ª—è —Ñ–æ—Ä–º—ã
                        const form = document.querySelector(
                            `form[data-endpoint="${endpoint}"]`
                        );
                        if (form) form.reset();
                    } else {
                        notification.className = "notification error";
                        notification.textContent = `–û—à–∏–±–∫–∞: ${
                            result.message || "–ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫"
                        }`;
                    }

                    return result;
                } catch (error) {
                    const notification =
                        document.getElementById(notificationId);
                    notification.style.display = "block";
                    notification.className = "notification error";
                    notification.textContent = `–û—à–∏–±–∫–∞: ${error.message}`;
                }
            }

            function clearAllRequests() {
                if (confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã?")) {
                    localStorage.removeItem("requests");
                    // –ù–∞—Ö–æ–¥–∏–º –∏ —É–¥–∞–ª—è–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã endpoint, –∫—Ä–æ–º–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö (login –∏ register)
                    const endpoints = document.querySelectorAll(".endpoint");
                    endpoints.forEach((endpoint) => {
                        if (
                            !endpoint.querySelector(
                                'form[data-endpoint="/login"]'
                            ) &&
                            !endpoint.querySelector(
                                'form[data-endpoint="/register"]'
                            )
                        ) {
                            endpoint.remove();
                        }
                    });

                    // –î–æ–±–∞–≤–∏–º –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                    const notification = document.createElement("div");
                    notification.style.cssText = `
                        position: fixed;
                        top: 20px;
                        right: 20px;
                        background: #e83e8c;
                        color: white;
                        padding: 15px;
                        border-radius: 4px;
                        animation: slideIn 0.5s ease-out;
                    `;
                    notification.textContent =
                        "–í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã —É–¥–∞–ª–µ–Ω—ã!";
                    document.body.appendChild(notification);

                    setTimeout(() => notification.remove(), 3000);
                }
            }

            function deleteRequest(requestName) {
                if (confirm(`–£–¥–∞–ª–∏—Ç—å –∑–∞–ø—Ä–æ—Å "${requestName}"?`)) {
                    // –£–¥–∞–ª—è–µ–º –∏–∑ localStorage
                    const savedRequests = JSON.parse(
                        localStorage.getItem("requests") || "[]"
                    );
                    const updatedRequests = savedRequests.filter(
                        (req) => req.name !== requestName
                    );
                    localStorage.setItem(
                        "requests",
                        JSON.stringify(updatedRequests)
                    );

                    // –ù–∞—Ö–æ–¥–∏–º –∏ —É–¥–∞–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç –∏–∑ DOM —Å—Ä–∞–∑—É
                    const endpoints = document.querySelectorAll(".endpoint");
                    const endpointToDelete = Array.from(endpoints).find(
                        (endpoint) => {
                            const h2 = endpoint.querySelector("h2");
                            return h2 && h2.textContent === requestName;
                        }
                    );

                    if (endpointToDelete) {
                        endpointToDelete.style.animation =
                            "fadeOut 0.3s ease-out";
                        setTimeout(() => endpointToDelete.remove(), 300);
                    }

                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É–¥–∞–ª–µ–Ω–∏–∏
                    const notification = document.createElement("div");
                    notification.style.cssText = `
                        position: fixed;
                        top: 20px;
                        right: 20px;
                        background: #f93e3e;
                        color: white;
                        padding: 15px;
                        border-radius: 4px;
                        animation: slideIn 0.5s ease-out;
                        z-index: 1001;
                    `;
                    notification.textContent = `–ó–∞–ø—Ä–æ—Å "${requestName}" —É–¥–∞–ª–µ–Ω!`;
                    document.body.appendChild(notification);

                    setTimeout(() => {
                        notification.style.animation = "fadeOut 0.5s ease-out";
                        setTimeout(() => notification.remove(), 500);
                    }, 3000);
                }
            }

            function editRequest(requestName) {
                const savedRequests = JSON.parse(
                    localStorage.getItem("requests") || "[]"
                );
                const request = savedRequests.find(
                    (req) => req.name === requestName
                );

                if (request) {
                    // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É –¥–∞–Ω–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞
                    document.getElementById("requestName").value = request.name;
                    document.getElementById("requestMethod").value =
                        request.method;
                    document.getElementById("requestUrl").value = request.url;

                    // –û—á–∏—â–∞–µ–º –∏ –∑–∞–ø–æ–ª–Ω—è–µ–º –ø–æ–ª—è –∑–∞–ø—Ä–æ—Å–∞
                    document.getElementById("requestFields").innerHTML = "";
                    request.requestFields.forEach((field) => {
                        const div = document.createElement("div");
                        div.className = "input-group";
                        div.innerHTML = `
                            <input type="text" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ–ª—è" value="${
                                field.name
                            }" required>
                            <select>
                                <option value="string" ${
                                    field.type === "string" ? "selected" : ""
                                }>String</option>
                                <option value="number" ${
                                    field.type === "number" ? "selected" : ""
                                }>Number</option>
                                <option value="boolean" ${
                                    field.type === "boolean" ? "selected" : ""
                                }>Boolean</option>
                            </select>
                            <button type="button" class="remove-field-btn" onclick="this.parentElement.remove()">–£–¥–∞–ª–∏—Ç—å</button>
                        `;
                        document
                            .getElementById("requestFields")
                            .appendChild(div);
                    });

                    // –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è –ø–æ–ª–µ–π –æ—Ç–≤–µ—Ç–∞
                    document.getElementById("responseFields").innerHTML = "";
                    request.responseFields.forEach((field) => {
                        const div = document.createElement("div");
                        div.className = "input-group";
                        div.innerHTML = `
                            <input type="text" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ–ª—è" value="${
                                field.name
                            }" required>
                            <select>
                                <option value="string" ${
                                    field.type === "string" ? "selected" : ""
                                }>String</option>
                                <option value="number" ${
                                    field.type === "number" ? "selected" : ""
                                }>Number</option>
                                <option value="boolean" ${
                                    field.type === "boolean" ? "selected" : ""
                                }>Boolean</option>
                            </select>
                            <button type="button" class="remove-field-btn" onclick="this.parentElement.remove()">–£–¥–∞–ª–∏—Ç—å</button>
                        `;
                        document
                            .getElementById("responseFields")
                            .appendChild(div);
                    });

                    // –û—Ç–∫—Ä—ã–≤–∞–µ–º –ø–æ–ø–∞–ø
                    openPopup();

                    // –û–±–Ω–æ–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã –¥–ª—è —Ä–µ–∂–∏–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                    const form = document.getElementById("newRequestForm");
                    form.onsubmit = function (e) {
                        e.preventDefault();

                        const requestData = {
                            name: document.getElementById("requestName").value,
                            method: document.getElementById("requestMethod")
                                .value,
                            url: document.getElementById("requestUrl").value,
                            requestFields: Array.from(
                                document.getElementById("requestFields")
                                    .children
                            ).map((field) => ({
                                name: field.querySelector("input").value,
                                type: field.querySelector("select").value,
                            })),
                            responseFields: Array.from(
                                document.getElementById("responseFields")
                                    .children
                            ).map((field) => ({
                                name: field.querySelector("input").value,
                                type: field.querySelector("select").value,
                            })),
                        };

                        // –û–±–Ω–æ–≤–ª—è–µ–º localStorage
                        const savedRequests = JSON.parse(
                            localStorage.getItem("requests") || "[]"
                        );
                        const updatedRequests = savedRequests.filter(
                            (req) => req.name !== requestName
                        );
                        updatedRequests.push(requestData);
                        localStorage.setItem(
                            "requests",
                            JSON.stringify(updatedRequests)
                        );

                        // –û–±–Ω–æ–≤–ª—è–µ–º DOM —Å—Ä–∞–∑—É
                        const endpoints =
                            document.querySelectorAll(".endpoint");
                        const oldEndpoint = Array.from(endpoints).find(
                            (endpoint) => {
                                const h2 = endpoint.querySelector("h2");
                                return h2 && h2.textContent === requestName;
                            }
                        );

                        if (oldEndpoint) {
                            // –ê–Ω–∏–º–∏—Ä—É–µ–º —É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
                            oldEndpoint.style.animation =
                                "fadeOut 0.3s ease-out";
                            setTimeout(() => {
                                oldEndpoint.remove();
                                // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π –ø–æ—è–≤–ª–µ–Ω–∏—è
                                const newEndpoint =
                                    createEndpointElement(requestData);
                                newEndpoint.style.animation =
                                    "slideIn 0.3s ease-out";
                            }, 300);
                        }

                        // –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø–æ–ø–∞–ø
                        document.getElementById("overlay").style.display =
                            "none";
                        document.getElementById("popup").style.display = "none";

                        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É
                        this.reset();

                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                        const notification = document.createElement("div");
                        notification.style.cssText = `
                            position: fixed;
                            top: 20px;
                            right: 20px;
                            background: #49cc90;
                            color: white;
                            padding: 15px;
                            border-radius: 4px;
                            animation: slideIn 0.5s ease-out;
                            z-index: 1001;
                        `;
                        notification.textContent = `–ó–∞–ø—Ä–æ—Å "${requestData.name}" —É—Å–ø–µ—à–Ω–æ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω!`;
                        document.body.appendChild(notification);

                        setTimeout(() => {
                            notification.style.animation =
                                "fadeOut 0.5s ease-out";
                            setTimeout(() => notification.remove(), 500);
                        }, 3000);

                        // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã
                        this.onsubmit = window.originalFormSubmit;

                        return false;
                    };
                }
            }

            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã
            window.originalFormSubmit =
                document.getElementById("newRequestForm").onsubmit;

            // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –∞–Ω–∏–º–∞—Ü–∏–π, –µ—Å–ª–∏ –∏—Ö –µ—â–µ –Ω–µ—Ç
            if (!document.querySelector("#notification-animations")) {
                const style = document.createElement("style");
                style.id = "notification-animations";
                style.textContent = `
                    @keyframes slideIn {
                        from { transform: translateX(100%); opacity: 0; }
                        to { transform: translateX(0); opacity: 1; }
                    }
                    
                    @keyframes fadeOut {
                        from { opacity: 1; transform: translateX(0); }
                        to { opacity: 0; transform: translateX(20px); }
                    }
                `;
                document.head.appendChild(style);
            }

            // –î–æ–±–∞–≤–∏–º –∫–Ω–æ–ø–∫–∏ –≤ header
            function addExportImportButtons() {
                const container = document.querySelector(".container div");

                // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É —ç–∫—Å–ø–æ—Ä—Ç–∞
                const exportBtn = document.createElement("button");
                exportBtn.className = "export-btn";
                exportBtn.onclick = exportRequests;
                exportBtn.innerHTML = "üì• –≠–∫—Å–ø–æ—Ä—Ç –∑–∞–ø—Ä–æ—Å–æ–≤";

                // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –∏–º–ø–æ—Ä—Ç–∞
                const importBtn = document.createElement("button");
                importBtn.className = "import-btn";
                importBtn.onclick = () =>
                    document.getElementById("importFile").click();
                importBtn.innerHTML = "üì§ –ò–º–ø–æ—Ä—Ç –∑–∞–ø—Ä–æ—Å–æ–≤";

                // –î–æ–±–∞–≤–ª—è–µ–º —Å–∫—Ä—ã—Ç—ã–π input –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞
                const importInput = document.createElement("input");
                importInput.type = "file";
                importInput.id = "importFile";
                importInput.accept = ".json";
                importInput.style.display = "none";
                importInput.onchange = importRequests;

                container.insertBefore(exportBtn, container.lastElementChild);
                container.insertBefore(importBtn, container.lastElementChild);
                container.appendChild(importInput);
            }

            // –§—É–Ω–∫—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
            function exportRequests() {
                const savedRequests = JSON.parse(
                    localStorage.getItem("requests") || "[]"
                );
                const dataStr = JSON.stringify(savedRequests, null, 2);
                const dataUri =
                    "data:application/json;charset=utf-8," +
                    encodeURIComponent(dataStr);

                const exportFileDefaultName = "api_requests.json";

                const linkElement = document.createElement("a");
                linkElement.setAttribute("href", dataUri);
                linkElement.setAttribute("download", exportFileDefaultName);

                // –ê–Ω–∏–º–∞—Ü–∏—è –∫–Ω–æ–ø–∫–∏
                const exportBtn = document.querySelector(".export-btn");
                exportBtn.style.animation = "pulse 0.3s ease";

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                const notification = document.createElement("div");
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: #49cc90;
                    color: white;
                    padding: 15px;
                    border-radius: 4px;
                    animation: slideIn 0.5s ease-out;
                    z-index: 1001;
                `;
                notification.textContent = "–ó–∞–ø—Ä–æ—Å—ã —É—Å–ø–µ—à–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã!";
                document.body.appendChild(notification);

                setTimeout(() => {
                    notification.style.animation = "fadeOut 0.5s ease-out";
                    setTimeout(() => notification.remove(), 500);
                }, 3000);

                linkElement.click();
            }

            // –§—É–Ω–∫—Ü–∏—è –∏–º–ø–æ—Ä—Ç–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
            function importRequests(event) {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function (e) {
                        try {
                            const requests = JSON.parse(e.target.result);

                            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
                            if (!Array.isArray(requests))
                                throw new Error("–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞");

                            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
                            localStorage.setItem(
                                "requests",
                                JSON.stringify(requests)
                            );

                            // –û—á–∏—â–∞–µ–º —Ç–µ–∫—É—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã
                            const endpoints =
                                document.querySelectorAll(".endpoint");
                            endpoints.forEach((endpoint) => {
                                if (
                                    !endpoint.querySelector(
                                        'form[data-endpoint="/login"]'
                                    ) &&
                                    !endpoint.querySelector(
                                        'form[data-endpoint="/register"]'
                                    )
                                ) {
                                    endpoint.remove();
                                }
                            });

                            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
                            requests.forEach((request) => {
                                createEndpointElement(request);
                            });

                            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
                            const notification = document.createElement("div");
                            notification.style.cssText = `
                                position: fixed;
                                top: 20px;
                                right: 20px;
                                background: #49cc90;
                                color: white;
                                padding: 15px;
                                border-radius: 4px;
                                animation: slideIn 0.5s ease-out;
                                z-index: 1001;
                            `;
                            notification.textContent =
                                "–ó–∞–ø—Ä–æ—Å—ã —É—Å–ø–µ—à–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã!";
                            document.body.appendChild(notification);

                            setTimeout(() => {
                                notification.style.animation =
                                    "fadeOut 0.5s ease-out";
                                setTimeout(() => notification.remove(), 500);
                            }, 3000);
                        } catch (error) {
                            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
                            const notification = document.createElement("div");
                            notification.style.cssText = `
                                position: fixed;
                                top: 20px;
                                right: 20px;
                                background: #f93e3e;
                                color: white;
                                padding: 15px;
                                border-radius: 4px;
                                animation: slideIn 0.5s ease-out;
                                z-index: 1001;
                            `;
                            notification.textContent =
                                "–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ —Ñ–∞–π–ª–∞!";
                            document.body.appendChild(notification);

                            setTimeout(() => {
                                notification.style.animation =
                                    "fadeOut 0.5s ease-out";
                                setTimeout(() => notification.remove(), 500);
                            }, 3000);
                        }
                    };
                    reader.readAsText(file);
                }
                // –û—á–∏—â–∞–µ–º input –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–≥–æ –∂–µ —Ñ–∞–π–ª–∞
                event.target.value = "";
            }

            // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –¥–ª—è –Ω–æ–≤—ã—Ö –∫–Ω–æ–ø–æ–∫
            const style = document.createElement("style");
            style.textContent = `
                .export-btn, .import-btn {
                    background: #61affe;
                    color: white;
                    border: none;
                    padding: 10px 20px;
                    border-radius: 4px;
                    cursor: pointer;
                    margin-right: 10px;
                    transition: transform 0.2s ease, box-shadow 0.2s ease;
                }
                
                .export-btn:hover, .import-btn:hover {
                    transform: translateY(-2px);
                    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
                }
                
                .export-btn:active, .import-btn:active {
                    transform: translateY(0);
                }
                
                @keyframes pulse {
                    0% { transform: scale(1); }
                    50% { transform: scale(1.05); }
                    100% { transform: scale(1); }
                }
            `;
            document.head.appendChild(style);

            // –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–Ω–æ–ø–æ–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            document.addEventListener(
                "DOMContentLoaded",
                addExportImportButtons
            );
        </script>

        <div class="endpoint">
            <div
                style="
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                "
            >
                <h2>–¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å</h2>
                <div class="endpoint-controls">
                    <button
                        onclick="editRequest('–¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å')"
                        class="control-btn edit-btn"
                    >
                        ‚úé –ò–∑–º–µ–Ω–∏—Ç—å
                    </button>
                    <button
                        onclick="deleteRequest('–¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å')"
                        class="control-btn delete-btn"
                    >
                        ‚úï –£–¥–∞–ª–∏—Ç—å
                    </button>
                </div>
            </div>
            <div>
                <span class="method post">POST</span>
                <span class="url">http://localhost:8080/api/test</span>
            </div>
            <div id="test-notification" class="notification"></div>
            <form data-endpoint="/api/test">
                <div class="input-group">
                    <label>username:</label>
                    <input type="text" name="username" required />
                </div>
                <div class="input-group">
                    <label>email:</label>
                    <input type="email" name="email" required />
                </div>
                <div class="input-group">
                    <label>age:</label>
                    <input type="number" name="age" required />
                </div>
                <button type="submit" class="submit-btn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
            </form>
            <pre class="request-body">
–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:
{
    "username": "john_doe",
    "email": "john@example.com",
    "age": 25
}</pre
            >
            <pre class="response-body">
–û—Ç–≤–µ—Ç:
{
    "id": "12345",
    "status": "success",
    "message": "User created successfully",
    "data": {
        "username": "john_doe",
        "email": "john@example.com",
        "age": 25,
        "createdAt": "2024-01-01T12:00:00Z"
    }
}</pre
            >
        </div>
    </body>
</html>
